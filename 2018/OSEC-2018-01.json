{
  "schema_version": "1.7.4",
  "id": "OSEC-2018-01",
  "modified": "2025-12-16T12:00:00Z",
  "published": "2018-04-06T18:29:00Z",
  "aliases": [
    "CVE-2018-9838"
  ],
  "summary": "An integer overflow in the `bigarray` serialization module leads to arbitrary code execution",
  "details": "## Bug description\n\nThe bigarray module in all recent ocaml versions is capable of reading in serialized (marshalled) objects from a external source which is often used for network operations and interprocess communication.\n\nbyterun/bigarray.c\n\nLine 458 in ea60609\n```C\n b->data = malloc(elt_size * num_elts);\n```\n\nA integer overflow vulnerability allows under certain circumstances an remote attacker to input a corrupt object and edit arbitrary addresses in the processes memory which leads over common techniques (in this take libc one gadget but any rop gadget or got table vector would work) to arbitrary memory access (!) and in the course also arbitrary code execution\n\nPlease check the writeup.pdf for more details !!\n\nIn variations of this the exploit is usable in all ocaml versions we tested no matter if compiled to binary or intepreted (!)\n\n## Steps to reproduce\n\nCheck out the attached archive and run the makefile (or use the precompile executable)\nthe exploit can be run by executing exploit.py (python2.7 and pwntools are required)\nThe last step of code execution is using a one-gadget attack technique and is specific to the glibc version in use (e.g. tested is debian glibc 2.24-11+deb9u1) but can with minimal amount of work be ported to any libc version on any patch level to our knowledge\n\nOf course you can also use the exploit.py to write your own version of exploit\n\n## Additional information\n\nThis Vulnerability in ocaml was discovered by me (maximilian.tschirschnitz@gmx.de) and the exploit collaboratly developed with (philipp.hagenlocher@tum.de)\nFor illustration purposes it was packaged as security challenge to demonstrate the impact of the issue (see writeup.pdf)",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "opam",
        "name": "ocaml",
        "purl": "pkg:opam/ocaml"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "4.07.0"
            }
          ]
        },
        {
          "type": "GIT",
          "repo": "https://github.com/ocaml/ocaml",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "9664c7ee807c2dfa802f53cabd405ff58e219c47"
            }
          ]
        }
      ],
      "versions": [
        "3.07",
        "3.07+1",
        "3.07+2",
        "3.08.0",
        "3.08.1",
        "3.08.2",
        "3.08.3",
        "3.08.4",
        "3.09.0",
        "3.09.1",
        "3.09.2",
        "3.09.3",
        "3.10.0",
        "3.10.1",
        "3.10.2",
        "3.11.0",
        "3.11.1",
        "3.11.2",
        "3.12.0",
        "3.12.1",
        "4.00.0",
        "4.00.1",
        "4.01.0",
        "4.02.0",
        "4.02.1",
        "4.02.2",
        "4.02.3",
        "4.02.4",
        "4.03.0",
        "4.03.1",
        "4.04.0",
        "4.04.1",
        "4.04.2",
        "4.04.3",
        "4.05.0",
        "4.05.1",
        "4.06.0",
        "4.06.1",
        "4.06.2"
      ],
      "ecosystem_specific": {
        "opam_constraint": "ocaml {< \"4.07.0\"}"
      }
    }
  ],
  "references": [
    {
      "type": "REPORT",
      "url": "https://github.com/ocaml/ocaml/issues/7765"
    },
    {
      "type": "FIX",
      "url": "https://github.com/ocaml/ocaml/pull/1718"
    }
  ],
  "credits": [
    {
      "name": "Maximilian Tschirschnitz",
      "contact": [
        "mailto:maximilian.tschirschnitz@gmx.de"
      ],
      "type": "REPORTER"
    },
    {
      "name": "Philipp Hagenlocher",
      "contact": [
        "mailto:philipp.hagenlocher@tum.de"
      ],
      "type": "REPORTER"
    },
    {
      "name": "Xavier Leroy",
      "type": "REMEDIATION_DEVELOPER"
    },
    {
      "name": "Gabriel Scherer",
      "type": "REMEDIATION_REVIEWER"
    }
  ],
  "database_specific": {
    "osv": "https://github.com/ocaml/security-advisories/tree/generated-osv/2018/OSEC-2018-01.json",
    "human_link": "https://github.com/ocaml/security-advisories/tree/main/advisories/2018/OSEC-2018-01.md"
  }
}
