{
  "schema_version": "1.7.4",
  "id": "OSEC-2016-01",
  "modified": "2026-01-01T12:00:00Z",
  "published": "2016-04-29T00:18:22Z",
  "aliases": [
    "CVE-2015-8869"
  ],
  "summary": "Buffer overflow and information leak in OCaml < 4.03.0",
  "details": "## Bug description\n\nOCaml versions 4.02.3 and earlier have a runtime bug that, on 64-bit platforms, causes sizes arguments to an internal memmove call to be sign-extended from 32 to 64-bits before being passed to the memmove function.\n\nThis leads arguments between 2GiB and 4GiB to be interpreted as larger than they are (specifically, a bit below 2^64), causing a buffer overflow.\n\nArguments between 4GiB and 6GiB are interpreted as 4GiB smaller than they should be, causing a possible information leak.\n\nThis commit fixes the bug:\nhttps://github.com/ocaml/ocaml/commit/659615c7b100a89eafe6253e7a5b9d84d0e8df74#diff-a97df53e3ebc59bb457191b496c90762\nThe function caml_bit_string is called indirectly from such functions as String.copy. String.copy for instance is supposed to be a \"safe\" function for which OCaml's memory safety guarantees apply.",
  "affected": [
    {
      "package": {
        "ecosystem": "opam",
        "name": "ocaml",
        "purl": "pkg:opam/ocaml"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "4.03.0"
            }
          ]
        },
        {
          "type": "GIT",
          "repo": "git+https://github.com/ocaml/ocaml",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "659615c7b100a89eafe6253e7a5b9d84d0e8df74"
            }
          ]
        }
      ],
      "versions": [
        "3.07",
        "3.07+1",
        "3.07+2",
        "3.08.0",
        "3.08.1",
        "3.08.2",
        "3.08.3",
        "3.08.4",
        "3.09.0",
        "3.09.1",
        "3.09.2",
        "3.09.3",
        "3.10.0",
        "3.10.1",
        "3.10.2",
        "3.11.0",
        "3.11.1",
        "3.11.2",
        "3.12.0",
        "3.12.1",
        "4.00.0",
        "4.00.1",
        "4.01.0",
        "4.02.0",
        "4.02.1",
        "4.02.2",
        "4.02.3",
        "4.02.4"
      ],
      "ecosystem_specific": {
        "opam_constraint": "ocaml {< \"4.03.0\"}"
      }
    }
  ],
  "references": [
    {
      "type": "REPORT",
      "url": "https://github.com/ocaml/ocaml/issues/7003"
    }
  ],
  "credits": [
    {
      "name": "Radek Micek",
      "type": "REPORTER"
    },
    {
      "name": "Damien Doligez",
      "type": "REMEDIATION_DEVELOPER"
    }
  ],
  "database_specific": {
    "osv": "https://github.com/ocaml/security-advisories/tree/generated-osv/2016/OSEC-2016-01.json",
    "human_link": "https://github.com/ocaml/security-advisories/tree/main/advisories/2016/OSEC-2016-01.md"
  }
}
